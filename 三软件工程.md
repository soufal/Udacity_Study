## 三、软件工程：  

[TOC]

### （一）软件工程实践第 1 部分

#### 1. 课程大纲：

将了解以下软件工程实践及其在数据科学中的应用：

- 编写整洁和模块化的代码
- 编写高效的代码
- 代码重构
- 添加有意义的文档注释
- 使用版本控制

#### 2. 整洁和模块化的代码：

- **生产代码：**在生产服务器上运行的代码，用于处理在生产服务器上运行的软件，以及用户和目标受众的实时数据。注意，生产代码并不等同于**生产级质量代码**，后者是指满足生产的可靠性、效率等期望的代码。理想情况下，生产中的所有代码都应符合这些期望，但通常都不是这样。
- **整洁：**可读、简单、精炼。生产级质量代码的特征之一，对软件开发中的协作和可维护性至关重要。
- **模块化：**逻辑性地分解为函数和模块。这也是生产级质量代码的一个重要特征，它使代码更有条理，更高效，可复用性更高。*将细节抽象为函数和模块，提高代码的可读性。*
- **模块：**也就是文件。将代码封装为文件，这些文件可导入其他文件中进行代码复用。



##### (1) 编写简洁的代码：

> **提示1：使用有意义的名称**
>
> - **具有描述性并暗示类型** - 比如：对于布尔值来说，使用 `is_` 或 `has_` 前缀来表明这是一个条件。你也可以使用词性来暗示类型，比如对函数名用动词，对变量名用名词。
> - **保持一致但明确区分** - 比如 `age_list` 和 `age` 比起 `ages` 和 `age` 来要更容易区分。
> - **避免缩写，尤其是单个字母** - （例外：计数器和常用数学变量）根据你的代码受众而决定选择何时适用于这些例外情况，如果你与其他数据科学家合作，某些特定的变量名可能是常识，如果你和全栈工程师一起工作，在这些情况下可能还需要提供更具描述性的名称。
> - **长名称 != 描述性名称** - 你应该具有描述性，但是仅限于相关信息。比如，好的函数名描述其功能，但是不需要包含有关实现或者高度特定用途的详细信息。



> **提示1：恰当使用空白**
>
> - 使用一致的缩进来组织代码 - 标准是每个缩进使用 4 个空格。你可以在文本编辑器中将其设置为默认值。
> - 使用空行分隔各个代码部分，使代码更易组织和阅读。
> - 尝试将行限制为大约 79 个字符，这是 PEP 8 样式指南中给出的规范。在许多优秀的文本编辑器中，有设置可以显示一条浅色的竖线，指示 79 个字符限制的位置。



##### (2) 编写模块化代码：

> **提示1：DRY（Don't Repeat Yourself 不要重复自己）**
>
> 不要重复自己！模块化可以帮助你复用代码，使用函数或循环，将重复的代码通用化并整合。

> **提示2：将逻辑抽象出来提高可读性**
>
> 将代码抽象到函数中不仅使其重复性降低，而且描述性的函数名还提高了可读性。将逻辑抽象为函数时，代码虽然可以变得更具可读性，但是可能会出现过度设计的情况，最终的模块过多，因此需要判断。

> **提示3：函数、类、模块等实体数量最小化**
>
> 选择函数调用还是使用内联逻辑需要进行权衡，如果将代码拆分为很多不必要的函数和模块，那么当你想要查看某个很小功能的实现详情时，可能都需要到处跳着查看，增加了工作量，创建更多的模块不等于更有效的模块化。

> **提示4：函数应该只做一件事**
>
> 每个函数都应该专注于做一件事。如果函数执行多项操作，则会使通用和复用变得更加困难。通常，如果函数名中有 "and"，请考虑重构。

> **提示5：任意变量名在某些函数中可能更有效**
>
> 一般函数中的任意变量名实际上可以使代码更具可读性。

> **提示6：尽量在每个函数中使用少于 3 个参数**
>
> 尽可能尝试使用不超过三个参数。这不是一个硬性规则，有时确实多个参数更加恰当。但在大多数情况下，使用较少的参数会更有效。请记住，我们正在模块化以简化代码并使其更有效地使用。如果你的函数有很多参数，可能需要重新考虑如何拆分它。





#### 3. 重构代码：

- **重构（Refactoring）：**重新构造代码，改进其内部结构，不改变其外部功能。在完成功能完整的代码后，将代码进行整理和模块化。
- 在尝试完善代码功能时，并不容易遵循最好的代码规范，因此分配时间来生成高质量代码至关重要。尽管最开始需要时间和精力，但从长远来看，这可以加快开发时间，获得回报。
- 不断寻求改进代码时，你也将成为一名更强大的编程人员。重构的经历越多，第一次构造和编写优秀的代码就越容易。

##### (1) 高效代码：

优化代码以提高效率可能意味着：

- 更快的执行时间
  - **尽可能使用向量运算而不是循环（使用NUmpy和pandas的函数替代循环。**
    - 例如使用`numpy.intersect1d`得到两个数组的交集。
  - 仔细检查Python中是否存在可用于更高效完成任务的数据结构或方法。
    - [为什么集合比列表更快](https://stackoverflow.com/questions/8929284/what-makes-sets-faster-than-lists/8929445#8929445)
  - 
- 占用内存/存储空间更少

#### 4. 注释：

- **文档注释：**软件代码附带或嵌入的附加文本或插图信息。
- 有助于解释复杂的代码部分，使代码更易于浏览，快速传达程序的不同组件的使用方式和原理。
- 可以在程序的不同级别添加几种类型的文档注释：
  - **行注释（In-line Comments）** - 代码行级别
  
    - 行注释是代码中哈希符号（`#`）后面的文本，用于解释部分代码，对未来的贡献者理解你的工作有很大的帮助。
    - 注释的一种用途是**记录复杂代码的主要步骤，帮助读者理解使用**。这样的话，你不需要完全理解代码，就可以了解函数功能。然而也有人会认为这种使用注释的方式证明代码写的不好，如果代码需要注释才能理解，则表明该代码需要重构。
    - **注释对于解释代码无法解释的内容很有价值**。例如，某种方法以特定方式实现的历史原因。有时可能会因为一些模糊的外部变量导致的副作用，采用非常规或看似随意的方法，这些东西很难用代码来解释。
  
  - **文档字符串（Docstrings）** - 模块或函数级别
  
    - Docstring 或文档字符串是**解释代码中函数或模块功能的有价值的文档片段**。理想情况下，每个函数都应该具有一个文档字符串。
  
    - 文档字符串使用三重引号将内容括起来，其中的第一行是对函数用途的简要介绍。
  
      * 单行文档字符串
  
      ```python
      def population_density(population, land_area):
          """Calculate the population density of an area."""
          return population / land_area
      ```
  
      如果你认为函数功能复杂，需要更长的描述，可以在一行摘要后添加更完整的段落。
  
      * 多行文档字符串
  
      ```python
      def population_density(population, land_area):
          """Calculate the population density of an area.
      
          Args:
          population: int. The population of the area
          land_area: int or float. This function is unit-agnostic, if you pass in values in terms of square km or square miles the function will return a density in those units.
      
          Returns:
          population_density: population/land_area. The population density of a
          particular area.
          """
          return population / land_area
      ```
  
      * 文档字符串的下一个元素是**对函数参数的解释，在这部分中列出参数，陈述其目的，说明该参数应该是什么类型**。最后，通常会提供关于函数返回值的一些描述。文档字符串的每一部分都是可选的，但是文档字符串是良好编码实践的一部分。
  
  - **项目文档（Project Documentation）** - 项目级别
  
    - 项目文档对于他人了解代码的原理和目的非常重要，无论他们是项目的潜在用户，还是可能为代码做出贡献的开发者。项目文档的第一步是 `README` 文件，该文件通常是大多数用户与你项目的第一次互动。
    - 无论是应用程序还是程序包，你的项目都应该带有 `README` 文件。**该文件至少应解释项目的作用，列出其依赖库，并提供足够详细的使用说明，让其他人尽可能简单地了解项目的目的，快速使用项目完成某些工作**。
    - 将所有想法和思路“翻译为”正式的书面语言可能有些困难，但随着时间的推移，你会做的越来越好，并在帮助其他人实现项目价值方面发挥重要作用。编写项目文档还可以帮助你改进代码的设计，因为你必须更彻底地思考设计决策。这也可以让未来的代码贡献者知道如何遵循你的原始意图。

